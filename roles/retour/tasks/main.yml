- name: Creer repertoire du serveur web
  file:
    path: /appli/mediawiki/01.01.00_sauvegarde/sql
    state: directory

- name: Creer le fichier de sauvegarde
  file:
    path: /appli/mediawiki/01.01.00_sauvegarde/sql/mediawiki.sql
    state: touch

- name: exporter la base de donnees
  mysql_db:
    state: dump
    name: mediawiki_db
    target: /appli/mediawiki/01.01.00_sauvegarde/sql/mediawiki.sql

- name: Delete directory wiki_devops
  file:
    path: /appli/projects/mediawiki/httpd/wiki_devops/
    state: absent

- name: Delete bdd mediawiki_db
  mysql_db:
    name: mediawiki_db
    state: absent

- name: Import sql version 01.00.00
  mysql_db:
    state: import
    name: mediawiki_db
    target: /appli/mediawiki/01.00.00_sauvegarde/sql/mediawiki.sql

- name: Copy directory
  command: cp -r /appli/mediawiki/01.00.00_sauvegarde/wiki_devops /appli/projects/mediawiki/httpd/
